---
title: ngx_http_realip_module
description: ngx_http_realip_module
toc: true
nd-org-source: http/ngx_http_realip_module.xml
nd-plus: false
nd-partial-plus: false
---


<!--
      ********************************************************************************
      ðŸ›‘ WARNING: AUTOGENERATED FILE - DO NOT EDIT ðŸ›‘ This Markdown file was
      automatically generated from the source XML documentation. Any manual
      changes made directly to this file will be overwritten. To request or
      suggest changes, please edit the source XML files instead.
      https://github.com/nginx/nginx.org/tree/main/xml/en
      ********************************************************************************
      -->


The `ngx_http_realip_module` module is used
to change the client address and optional port
to those sent in the specified header field.

This module is not built by default, it should be enabled with the
`--with-http_realip_module`
configuration parameter.
## Example Configuration


```nginx
set_real_ip_from  192.168.1.0/24;
set_real_ip_from  192.168.2.1;
set_real_ip_from  2001:0db8::/32;
real_ip_header    X-Forwarded-For;
real_ip_recursive on;

```

## Directives

### set_real_ip_from

{{< call-out >}}

**Syntax:** set_real_ip_from `address` | `CIDR` | `unix:`

**Default:** -

**Context:** http, server, location


{{</call-out>}}


Defines trusted addresses that are known to send correct
replacement addresses.
If the special value `unix:` is specified,
all UNIX-domain sockets will be trusted.
Trusted addresses may also be specified using a hostname (1.13.1).

IPv6 addresses are supported starting from versions 1.3.0 and 1.2.1.
### real_ip_header

{{< call-out >}}

**Syntax:** real_ip_header `field` | `X-Real-IP` | `X-Forwarded-For` | `proxy_protocol`

**Default:** X-Real-IP

**Context:** http, server, location


{{</call-out>}}


Defines the request header field
whose value will be used to replace the client address.

The request header field value that contains an optional port
is also used to replace the client port (1.11.0).
The address and port should be specified according to
[RFC 3986](https://datatracker.ietf.org/doc/html/rfc3986).

The `proxy_protocol` parameter (1.5.12) changes
the client address to the one from the PROXY protocol header.
The PROXY protocol must be previously enabled by setting the
`proxy_protocol` parameter
in the [listen](/nginx/module-reference/http/ngx_http_core_module#listen) directive.
### real_ip_recursive

{{< call-out >}}

**Syntax:** real_ip_recursive `on` | `off`

**Default:** off

**Context:** http, server, location

_This directive appeared in version 1.3.0._


{{</call-out>}}


If recursive search is disabled, the original client address that
matches one of the trusted addresses is replaced by the last
address sent in the request header field defined by the
[](#real_ip_header) directive.
If recursive search is enabled, the original client address that
matches one of the trusted addresses is replaced by the last
non-trusted address sent in the request header field.
## Embedded Variables

`$realip_remote_addr`
keeps the original client address (1.9.7)
`$realip_remote_port`
keeps the original client port (1.11.0)
