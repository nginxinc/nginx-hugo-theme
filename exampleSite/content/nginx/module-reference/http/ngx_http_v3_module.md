---
title: ngx_http_v3_module
description: ngx_http_v3_module
toc: true
nd-org-source: http/ngx_http_v3_module.xml
nd-plus: false
nd-partial-plus: false
---


<!--
      ********************************************************************************
      üõë WARNING: AUTOGENERATED FILE - DO NOT EDIT üõë This Markdown file was
      automatically generated from the source XML documentation. Any manual
      changes made directly to this file will be overwritten. To request or
      suggest changes, please edit the source XML files instead.
      https://github.com/nginx/nginx.org/tree/main/xml/en
      ********************************************************************************
      -->


The `ngx_http_v3_module` module (1.25.0) provides
experimental support for
[HTTP/3](https://datatracker.ietf.org/doc/html/rfc9114).

This module is not built by default, it should be enabled with the
[`--with-http_v3_module`](/nginx/module-reference/../configure#http_v3_module)
configuration parameter.

An SSL library that provides QUIC support
such as
[BoringSSL](https://boringssl.googlesource.com/boringssl),
[LibreSSL](https://www.libressl.org), or
[QuicTLS](https://github.com/quictls/openssl)
is recommended to build and run this module.
Otherwise,
when using the [OpenSSL](https://openssl.org) library,
OpenSSL compatibility layer will be used that does not support
[early data](/nginx/module-reference/http/ngx_http_ssl_module#ssl_early_data).
## Known Issues


The module is experimental, caveat emptor applies.
## Example Configuration


```nginx
http {
    log_format quic '$remote_addr - $remote_user [$time_local] '
                    '"$request" $status $body_bytes_sent '
                    '"$http_referer" "$http_user_agent" "$http3"';

    access_log logs/access.log quic;

    server {
        # for better compatibility it's recommended
        # to use the same port for http/3 and https
        listen 8443 quic reuseport;
        listen 8443 ssl;

        ssl_certificate     certs/example.com.crt;
        ssl_certificate_key certs/example.com.key;

        location / {
            # used to advertise the availability of HTTP/3
            add_header Alt-Svc 'h3=":8443"; ma=86400';
        }
    }
}

```


Note that accepting HTTP/3 connections over TLS requires
the TLSv1.3 protocol support, which is available since
[OpenSSL](http://www.openssl.org) version 1.1.1.
## Directives

### http3

{{< call-out >}}

**Syntax:** http3 `on` | `off`

**Default:** on

**Context:** http, server


{{</call-out>}}


Enables
[HTTP/3](https://datatracker.ietf.org/doc/html/rfc9114)
protocol negotiation.
### http3_hq

{{< call-out >}}

**Syntax:** http3_hq `on` | `off`

**Default:** off

**Context:** http, server


{{</call-out>}}


Enables HTTP/0.9 protocol negotiation
used in
[QUIC
interoperability tests](https://github.com/marten-seemann/quic-interop-runner).
### http3_max_concurrent_streams

{{< call-out >}}

**Syntax:** http3_max_concurrent_streams `number`

**Default:** 128

**Context:** http, server


{{</call-out>}}


Sets the maximum number of concurrent HTTP/3 request streams
in a connection.
### http3_stream_buffer_size

{{< call-out >}}

**Syntax:** http3_stream_buffer_size `size`

**Default:** 64k

**Context:** http, server


{{</call-out>}}


Sets the size of the buffer used for reading and writing of the
QUIC streams.
### quic_active_connection_id_limit

{{< call-out >}}

**Syntax:** quic_active_connection_id_limit `number`

**Default:** 2

**Context:** http, server


{{</call-out>}}


Sets the
QUIC `active_connection_id_limit` transport parameter value.
This is the maximum number of client connection IDs
which can be stored on the server.
### quic_bpf

{{< call-out >}}

**Syntax:** quic_bpf `on` | `off`

**Default:** off

**Context:** main


{{</call-out>}}


Enables routing of QUIC packets using
[eBPF](https://ebpf.io/).
When enabled, this allows supporting QUIC connection migration.

The directive is only supported on Linux 5.7+.
### quic_gso

{{< call-out >}}

**Syntax:** quic_gso `on` | `off`

**Default:** off

**Context:** http, server


{{</call-out>}}


Enables sending in optimized batch mode
using segmentation offloading.

Optimized sending is supported only on Linux
featuring `UDP_SEGMENT`.
### quic_host_key

{{< call-out >}}

**Syntax:** quic_host_key `file`

**Default:** -

**Context:** http, server


{{</call-out>}}


Sets a `file` with the secret key used to encrypt
stateless reset and address validation tokens.
By default, a random key is generated on each reload.
Tokens generated with old keys are not accepted.
### quic_retry

{{< call-out >}}

**Syntax:** quic_retry `on` | `off`

**Default:** off

**Context:** http, server


{{</call-out>}}


Enables the
[QUIC
Address Validation](https://datatracker.ietf.org/doc/html/rfc9000#name-address-validation) feature.
This includes sending a new token in a `Retry` packet
or a `NEW_TOKEN` frame
and
validating a token received in the `Initial` packet.
## Embedded Variables


The `ngx_http_v3_module` module
supports the following embedded variables:
`$http3`
negotiated protocol identifier:
‚Äú`h3`‚Äù for HTTP/3 connections,
‚Äú`hq`‚Äù for hq connections,
or an empty string otherwise.
