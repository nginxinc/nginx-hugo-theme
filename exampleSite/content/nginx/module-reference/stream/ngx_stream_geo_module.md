---
title: ngx_stream_geo_module
description: ngx_stream_geo_module
toc: true
nd-org-source: stream/ngx_stream_geo_module.xml
nd-plus: false
nd-partial-plus: false
---


<!--
********************************************************************************
üõë WARNING: AUTOGENERATED FILE - DO NOT EDIT üõë
This Markdown file was automatically generated from the source XML documentation.
Any manual changes made directly to this file will be overwritten.
To request or suggest changes, please edit the source XML files instead.
https://github.com/nginx/nginx.org/tree/main/xml/en
********************************************************************************
-->


The `ngx_stream_geo_module` module (1.11.3) creates variables
with values depending on the client IP address.
## Example Configuration


```nginx
geo $geo {
    default        0;

    127.0.0.1      2;
    192.168.1.0/24 1;
    10.1.0.0/16    1;

    ::1            2;
    2001:0db8::/32 1;
}

```

## Directives

### geo

{{< call-out >}}

**Syntax:** geo [ `$address` ] `$variable`

**Default:** -

**Context:** stream


{{</call-out>}}


Describes the dependency of values of the specified variable
on the client IP address.
By default, the address is taken from the `$remote_addr` variable,
but it can also be taken from another variable, for example:

```nginx
geo $arg_remote_addr $geo {
    ...;
}

```


Since variables are evaluated only when used, the mere existence
of even a large number of declared ‚Äú`geo`‚Äù variables
does not cause any extra costs for connection processing.

If the value of a variable does not represent a valid IP address
then the ‚Äú`255.255.255.255`‚Äù address is used.

Addresses are specified either as prefixes in CIDR notation
(including individual addresses) or as ranges.

The following special parameters are also supported:
`delete`
deletes the specified network.
`default`
a value set to the variable if the client address does not
match any of the specified addresses.
When addresses are specified in CIDR notation,
‚Äú`0.0.0.0/0`‚Äù and ‚Äú`::/0`‚Äù
can be used instead of `default`.
When `default` is not specified, the default
value will be an empty string.
`include`
includes a file with addresses and values.
There can be several inclusions.
`ranges`
indicates that addresses are specified as ranges.
This parameter should be the first.
To speed up loading of a geo base, addresses should be put in ascending order.

Example:

```nginx
geo $country {
    default        ZZ;
    include        conf/geo.conf;
    delete         127.0.0.0/16;

    127.0.0.0/24   US;
    127.0.0.1/32   RU;
    10.1.0.0/16    RU;
    192.168.1.0/24 UK;
}

```


The conf/geo.conf file could contain the following lines:

```nginx
10.2.0.0/16    RU;
192.168.2.0/24 RU;

```


A value of the most specific match is used.
For example, for the 127.0.0.1 address the value ‚Äú`RU`‚Äù
will be chosen, not ‚Äú`US`‚Äù.

Example with ranges:

```nginx
geo $country {
    ranges;
    default                   ZZ;
    127.0.0.0-127.0.0.0       US;
    127.0.0.1-127.0.0.1       RU;
    127.0.0.1-127.0.0.255     US;
    10.1.0.0-10.1.255.255     RU;
    192.168.1.0-192.168.1.255 UK;
}

```

