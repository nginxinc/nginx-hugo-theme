<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">

<head>

  {{ block "head" . }}

  {{ partial "meta.html" . }}

  {{ partial "favicon.html" . }}

  {{ partial "styles.html" . }}

  {{ if in .Params.doctypes "devportal" }}
  {{ partial "devportal/style.html" . }}
  {{ end }}

  {{ if fileExists "/layouts/partials/head_custom.html" }}
  {{ partial "head_custom.html" . }}
  {{ end }}

  {{ if or ( not hugo.IsServer ) ( not ( in .Site.Params.buildtype "package" ) ) }}

  {{ partial "trustarc.html" . }}

  {{ partial "tealium-profile.html" . }}

  {{ end }}

  {{ end }}

  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-K5HG9JT');</script>

  <script>

    let storedTheme = null;
    try {
      storedTheme = localStorage.getItem("theme");
    } catch (e) {
      // Some environments block storage (privacy mode, etc.)
    }

    const mql = window.matchMedia
      ? window.matchMedia("(prefers-color-scheme: dark)")
      : null;
    const initialTheme = storedTheme || (mql && mql.matches ? "dark" : "light");
    document.documentElement.setAttribute("data-theme", initialTheme);

    document.addEventListener("DOMContentLoaded", () => {
      const toggle = document.getElementById("theme-toggle");
      if (!toggle) return;

      toggle.checked =
        document.documentElement.getAttribute("data-theme") === "dark";

      toggle.addEventListener("change", () => {
        const theme = toggle.checked ? "dark" : "light";
        document.documentElement.setAttribute("data-theme", theme);
        try {
          localStorage.setItem("theme", theme);
        } catch (e) {}
      });

      // Follow system preference only until the user picks a theme
      let hasUserChoice = false;
      try {
        hasUserChoice = localStorage.getItem("theme") !== null;
      } catch (e) {
        hasUserChoice = false;
      }

      if (!hasUserChoice && mql) {
        const onSystemChange = (e) => {
          try {
            if (localStorage.getItem("theme") !== null) return;
          } catch (err) {
            // continue following system if storage is blocked
          }
          const theme = e.matches ? "dark" : "light";
          document.documentElement.setAttribute("data-theme", theme);
          toggle.checked = theme === "dark";
        };

        if (typeof mql.addEventListener === "function") {
          mql.addEventListener("change", onSystemChange);
        } else if (typeof mql.addListener === "function") {
          mql.addListener(onSystemChange);
        }
      }
    });

    // Keep multiple tabs in sync so a change in one reflects in others
    window.addEventListener("storage", (e) => {
      if (e.key !== "theme") return;
      const theme = e.newValue || (mql && mql.matches ? "dark" : "light");
      document.documentElement.setAttribute("data-theme", theme);
      const toggle = document.getElementById("theme-toggle");
      if (toggle) toggle.checked = theme === "dark";
    });

  </script>
  </head>

  <body id="body">
    {{ if or ( not hugo.IsServer ) ( not ( in .Site.Params.buildtype "package" ) ) }}
    {{ partial "universal-tag.html" . }}
    {{ end }}
    <input type="checkbox" id="sidebar-panel" class="sidebar-panel" hidden/>
    <div class="grid-container">
        <aside class="sidebar">
            {{ partial "sidebar-v2.html" . }}
        </aside>

        <header class="header">
            {{ block "header" . }}{{end}}
        </header>

        {{ block "main" . }}{{ end }}

        <footer class="footer">
          {{ block "footer-v2" . }}
            {{ partial "footer-v2.html" . }}
          {{ end }}
        </footer>
    </div>


  {{ partial "scripts.html" . }}
  <div id="consent_blackbar"></div>
</body>
</html>
